{% extends 'base.html' %}

{% block title %}Cadastro de Atividades do Aluno{% endblock %}

{% block content %}
<style>
.tab-container {
    max-width: 900px;
    margin: 30px auto;
    background-color: white;
    border-radius: 8px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    padding: 20px;
    font-family: Arial, sans-serif;
    text-align: center;
}
.tabs {
    display: flex;
    justify-content: center;
    border-bottom: 1px solid #ccc;
    margin-bottom: 20px;
    gap: 10px;
}
.tabs button {
    background: none;
    border: none;
    padding: 10px 20px;
    cursor: pointer;
    font-weight: bold;
    border-bottom: 3px solid transparent;
    transition: 0.3s;
}
.tabs button.active {
    border-bottom: 3px solid #4CAF50;
}
.tab-content {
    display: none;
    text-align: left;
    max-width: 500px;
    margin: 0 auto;
}
.tab-content.active {
    display: block;
}
label {
    display: block;
    font-weight: bold;
    margin-top: 10px;
}
select, input {
    width: 100%;
    padding: 6px;
    margin-bottom: 12px;
    box-sizing: border-box;
    border-radius: 4px;
    border: 1px solid #ccc;
}
button.submit-btn {
    padding: 10px 20px;
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    margin-top: 10px;
}
h4 {
    margin-bottom: 20px;
}
ul {
    list-style: none;
    padding-left: 0;
}
ul li {
    background: #f9f9f9;
    margin-bottom: 6px;
    padding: 6px 10px;
    border-radius: 4px;
}
</style>

<div class="tab-container">
    <h4>| {{ aluno.nome }} | ID: {{ aluno.id }} | {{ aluno.idade }} anos |</h4>

    <h2>Cadastro de Atividades</h2>

    <div class="tabs">
        <button type="button" class="tab-link active" data-tab="oficina-tab">Oficinas</button>
        <button type="button" class="tab-link" data-tab="curso-tab">Cursos</button>
    </div>

    <!-- ABA OFICINAS -->
    <div class="tab-content active" id="oficina-tab">
        <form method="POST" action="{{ url_for('cadastrar_alunos_atividades', aluno_id=aluno.id) }}">
            <input type="hidden" name="tipo_atividade" value="Oficina">

            <<label>Atividade:</label>
<select name="id_atividade">
    <option value="">Selecione</option>
    {% for a in todas_oficinas_filtradas %}
        {% set dias_texto = a.dias_semana | join(', ') %}
        <option value="{{ a.id }}">
            {{ a.nome }}
            {% if a.horario %}- {{ a.horario.strftime('%H:%M') }}{% endif %}
            {% if dias_texto %}
                - {{ dias_texto }}
            {% endif %}
        </option>
    {% endfor %}
</select>

            <button type="submit" class="submit-btn">Cadastrar Oficina</button>
        </form>

        <h3>Oficinas já cadastradas:</h3>
<ul>
    {% for a in aluno_oficinas %}
        <li>
            {{ a.nome }} {% if a.horario %}- {{ a.horario.strftime('%H:%M') }}{% endif %} - {{ a.dias_semana|join(', ') }}
            <form method="POST" action="{{ url_for('desativar_atividade_aluno', aluno_id=aluno.id, id_atividade=a.id) }}" style="display:inline;">
                <button type="submit" style="background:#f44336;color:white;border:none;padding:3px 6px;border-radius:3px;cursor:pointer;">Desativar</button>
            </form>
        </li>
    {% endfor %}
</ul>
    </div>

    <!-- ABA CURSOS -->
    <div class="tab-content" id="curso-tab">
        <form method="POST" action="{{ url_for('cadastrar_alunos_atividades', aluno_id=aluno.id) }}">
            <input type="hidden" name="tipo_atividade" value="Curso">

           <label>Curso:</label>
<select name="id_curso">
    <option value="">Selecione</option>
    {% for c in todos_cursos_filtrados %}
        {% set dias_texto = c.dias_semana | join(', ') %}
        <option value="{{ c.id }}">
            {{ c.nome }}
            {% if c.horario %}- {{ c.horario.strftime('%H:%M') }}{% endif %}
            {% if dias_texto %}
                - {{ dias_texto }}
            {% endif %}
        </option>
    {% endfor %}
</select>

            <button type="submit" class="submit-btn">Cadastrar Curso</button>
        </form>

        <h3>Cursos já cadastrados:</h3>
<ul>
    {% for a in aluno_cursos %}
        <li>
            {{ a.nome }}
            {% if a.horario %}- {{ a.horario.strftime('%H:%M') }}{% endif %}
            - {{ a.dias_semana|join(', ') }}

            <form method="POST" action="{{ url_for('desativar_atividade_aluno', aluno_id=aluno.id, id_atividade=a.id) }}" style="display:inline;">
                <button type="submit" style="background:#f44336;color:white;border:none;padding:3px 6px;border-radius:3px;cursor:pointer;">Desativar</button>
            </form>
        </li>
    {% endfor %}
</ul>
    </div>
</div>

<script>
const tabs = document.querySelectorAll('.tab-link');
const contents = document.querySelectorAll('.tab-content');
tabs.forEach(tab => {
    tab.addEventListener('click', () => {
        tabs.forEach(t => t.classList.remove('active'));
        contents.forEach(c => c.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById(tab.dataset.tab).classList.add('active');
    });
});
</script>
{% endblock %}
